<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ»‘å—æ‹¼å›¾</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            color: white;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        
        h1 {
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .game-info {
            display: flex;
            gap: 30px;
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .puzzle-container {
            display: grid;
            grid-template-columns: repeat(4, 80px);
            grid-template-rows: repeat(4, 80px);
            gap: 2px;
            background: #2c3e50;
            padding: 10px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .puzzle-tile {
            width: 80px;
            height: 80px;
            background: #3498db;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.2s ease;
            user-select: none;
        }
        
        .puzzle-tile:hover {
            background: #2980b9;
            transform: scale(1.05);
        }
        
        .puzzle-tile.empty {
            background: transparent;
            cursor: default;
        }
        
        .puzzle-tile.empty:hover {
            transform: none;
        }
        
        .controls {
            margin: 20px 0;
            text-align: center;
        }
        
        button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        button:hover {
            background: #c0392b;
        }
        
        .instructions {
            margin-top: 20px;
            text-align: center;
            color: white;
            max-width: 500px;
        }
        
        .solved {
            animation: celebration 1s ease-in-out;
        }
        
        @keyframes celebration {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
    </style>
</head>
<body>
    <h1>ğŸ§© æ»‘å—æ‹¼å›¾</h1>
    
    <div class="game-info">
        <div>æ­¥æ•°: <span id="moves">0</span></div>
        <div>æ—¶é—´: <span id="time">00:00</span></div>
        <div>çŠ¶æ€: <span id="status">æœªå¼€å§‹</span></div>
    </div>
    
    <div class="puzzle-container" id="puzzleContainer"></div>
    
    <div class="controls">
        <button onclick="newGame()">æ–°æ¸¸æˆ</button>
        <button onclick="shuffle()">æ‰“ä¹±</button>
        <button onclick="solve()">è§£ç­”</button>
        <button onclick="resetGame()">é‡ç½®</button>
    </div>
    
    <div class="instructions">
        <p>ç‚¹å‡»æ•°å­—å—ç§»åŠ¨åˆ°ç©ºä½ï¼ŒæŒ‰é¡ºåºæ’åˆ—æ‰€æœ‰æ•°å­—</p>
        <p>ç›®æ ‡æ˜¯å°†æ•°å­—æŒ‰ä»1åˆ°15çš„é¡ºåºæ’åˆ—ï¼Œç©ºä½åœ¨å³ä¸‹è§’</p>
    </div>

    <script>
        let gameStarted = false;
        let moves = 0;
        let startTime = 0;
        let gameTimer;
        let puzzle = [];
        let emptyPosition = { row: 3, col: 3 };
        
        const movesElement = document.getElementById('moves');
        const timeElement = document.getElementById('time');
        const statusElement = document.getElementById('status');
        const containerElement = document.getElementById('puzzleContainer');
        
        // åˆå§‹åŒ–æ‹¼å›¾
        function initPuzzle() {
            puzzle = [];
            let number = 1;
            
            for (let row = 0; row < 4; row++) {
                puzzle[row] = [];
                for (let col = 0; col < 4; col++) {
                    if (row === 3 && col === 3) {
                        puzzle[row][col] = 0; // ç©ºä½
                    } else {
                        puzzle[row][col] = number++;
                    }
                }
            }
            
            emptyPosition = { row: 3, col: 3 };
        }
        
        // æ¸²æŸ“æ‹¼å›¾
        function renderPuzzle() {
            containerElement.innerHTML = '';
            
            for (let row = 0; row < 4; row++) {
                for (let col = 0; col < 4; col++) {
                    const tile = document.createElement('div');
                    tile.className = 'puzzle-tile';
                    tile.dataset.row = row;
                    tile.dataset.col = col;
                    
                    if (puzzle[row][col] === 0) {
                        tile.classList.add('empty');
                    } else {
                        tile.textContent = puzzle[row][col];
                        tile.addEventListener('click', () => moveTile(row, col));
                    }
                    
                    containerElement.appendChild(tile);
                }
            }
        }
        
        // ç§»åŠ¨ç“¦ç‰‡
        function moveTile(row, col) {
            if (!gameStarted) return;
            
            // æ£€æŸ¥æ˜¯å¦å¯ä»¥ç§»åŠ¨ï¼ˆä¸ç©ºä½ç›¸é‚»ï¼‰
            const isAdjacent = (
                (Math.abs(row - emptyPosition.row) === 1 && col === emptyPosition.col) ||
                (Math.abs(col - emptyPosition.col) === 1 && row === emptyPosition.row)
            );
            
            if (!isAdjacent) return;
            
            // äº¤æ¢ç“¦ç‰‡å’Œç©ºä½
            puzzle[emptyPosition.row][emptyPosition.col] = puzzle[row][col];
            puzzle[row][col] = 0;
            
            emptyPosition = { row, col };
            moves++;
            movesElement.textContent = moves;
            
            renderPuzzle();
            
            // æ£€æŸ¥æ˜¯å¦è§£å†³
            if (isSolved()) {
                gameWon();
            }
        }
        
        // æ£€æŸ¥æ˜¯å¦è§£å†³
        function isSolved() {
            let number = 1;
            for (let row = 0; row < 4; row++) {
                for (let col = 0; col < 4; col++) {
                    if (row === 3 && col === 3) {
                        if (puzzle[row][col] !== 0) return false;
                    } else {
                        if (puzzle[row][col] !== number++) return false;
                    }
                }
            }
            return true;
        }
        
        // æ‰“ä¹±æ‹¼å›¾
        function shufflePuzzle(steps = 1000) {
            const directions = [
                { row: -1, col: 0 }, // ä¸Š
                { row: 1, col: 0 },  // ä¸‹
                { row: 0, col: -1 }, // å·¦
                { row: 0, col: 1 }   // å³
            ];
            
            for (let i = 0; i < steps; i++) {
                const validMoves = directions.filter(dir => {
                    const newRow = emptyPosition.row + dir.row;
                    const newCol = emptyPosition.col + dir.col;
                    return newRow >= 0 && newRow < 4 && newCol >= 0 && newCol < 4;
                });
                
                if (validMoves.length > 0) {
                    const randomMove = validMoves[Math.floor(Math.random() * validMoves.length)];
                    const newRow = emptyPosition.row + randomMove.row;
                    const newCol = emptyPosition.col + randomMove.col;
                    
                    // äº¤æ¢
                    puzzle[emptyPosition.row][emptyPosition.col] = puzzle[newRow][newCol];
                    puzzle[newRow][newCol] = 0;
                    emptyPosition = { row: newRow, col: newCol };
                }
            }
        }
        
        // æ›´æ–°è®¡æ—¶å™¨
        function updateTimer() {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
            const seconds = (elapsed % 60).toString().padStart(2, '0');
            timeElement.textContent = `${minutes}:${seconds}`;
        }
        
        // å¼€å§‹æ–°æ¸¸æˆ
        function newGame() {
            gameStarted = true;
            moves = 0;
            movesElement.textContent = '0';
            timeElement.textContent = '00:00';
            statusElement.textContent = 'æ¸¸æˆä¸­';
            
            initPuzzle();
            shufflePuzzle();
            renderPuzzle();
            
            startTime = Date.now();
            gameTimer = setInterval(updateTimer, 1000);
        }
        
        // åªæ‰“ä¹±ä¸é‡ç½®è®¡æ—¶
        function shuffle() {
            if (!gameStarted) {
                newGame();
                return;
            }
            
            shufflePuzzle();
            renderPuzzle();
        }
        
        // è‡ªåŠ¨è§£ç­”
        function solve() {
            initPuzzle();
            renderPuzzle();
            
            if (gameStarted) {
                gameWon();
            }
        }
        
        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            gameStarted = false;
            clearInterval(gameTimer);
            
            moves = 0;
            movesElement.textContent = '0';
            timeElement.textContent = '00:00';
            statusElement.textContent = 'æœªå¼€å§‹';
            
            initPuzzle();
            renderPuzzle();
        }
        
        // è·èƒœ
        function gameWon() {
            gameStarted = false;
            clearInterval(gameTimer);
            statusElement.textContent = 'æ¸¸æˆå®Œæˆ';
            
            containerElement.classList.add('solved');
            
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            
            setTimeout(() => {
                containerElement.classList.remove('solved');
                alert(`æ­å–œä½ å®Œæˆäº†æ‹¼å›¾ï¼\nç”¨æ—¶: ${minutes}åˆ†${seconds}ç§’\næ­¥æ•°: ${moves}`);
            }, 1000);
        }
        
        // åˆå§‹åŒ–
        initPuzzle();
        renderPuzzle();
    </script>
</body>
</html>